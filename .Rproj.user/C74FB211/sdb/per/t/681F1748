{
    "contents" : "\nrequire(fOptions)\n\n\nrub3mp = rubmrtk[, c('USD.RUB', 'swap3m_perc', 'iv3m')]\nnames(rub3mp) = c('rub', 'swap', 'iv')\nrub3mp$iv = rub3mp$iv/100\n\nrub3mp$put = (as.data.frame(rub3mp) %>% mutate(put = GBSOption('p', rub, rub, 90/365, swap, 0, iv)@price))[, c('put')]\nautoplot(rub3mp$put)\n\n\nrub3mp$rubdown = diff(rub3mp$rub, 90*5/7) \n\nrub3mp$rubdown[which(rub3mp$rubdown>0),]=0\n\n# Financial result at the start point\nrub3mp$result = (-lag(rub3mp$rubdown, k = -90*5/7) - rub3mp$put)\n\nrub3mp$resultperc = rub3mp$result / rub3mp$rub\nrub3mp$rubdownperc = rub3mp$rubdown / rub3mp$rub\n\nhead(rub3mp)\ntail(rub3mp)\n\nrub3mp$rubdown[which(is.na( rub3mp$rubdown))] = 0\nrub3mp$rubdownperc[which(is.na( rub3mp$rubdownperc))] = 0\nrub3mp$resultperc[which(is.na( rub3mp$resultperc))] = 0\n\nautoplot(rub3mp['2010/2015', c('rubdownperc', 'resultperc')], geom='area')\n\nsummary(rub3mp$resultperc['2010/2015'])\nhist(rub3mp$resultperc['2010/2015'], breaks = 30)\n\nqqnorm(na.omit(rub3mp$resultperc[,1]))\n",
    "created" : 1441370788405.000,
    "dirty" : false,
    "encoding" : "CP1251",
    "folds" : "",
    "hash" : "2365079046",
    "id" : "681F1748",
    "lastKnownWriteTime" : 1441373823,
    "path" : "~/RBackup/HedgeBacktest/putbacktest.R",
    "project_path" : "putbacktest.R",
    "properties" : {
        "tempName" : "Untitled1"
    },
    "source_on_save" : false,
    "type" : "r_source"
}